// Объединённый объект переводов для сайта и бронирования
const translations = {
  ru: {
    home: "Главная",
    services: "Услуги",
    about: "О нас",
    contacts: "Контакты",
    step1: "Выбор услуг",
    step2: "Выбор времени",
    step3: "Личные данные",
    step4: "Подтверждение",
    topBarber: "Top barber",
    goodBarber: "Good barber",
    juniorBarber: "Junior barber",
    maleHaircut: "Мужская стрижка",
    childHaircut: "Детская стрижка",
    extendedHaircut: "Удлиненная стрижка",
    beardStyling: "Оформление бороды",
    beardCamouflage: "Камуфлирование бороды",
    royalShave: "Королевское бритье",
    hairStyling: "Укладка волос",
    beardAndHaircut: "Борода + стрижка",
    hairTattoo: "Hair tatoo",
    waxing1: "Ваксинг 1 зона",
    waxing3: "Ваксинг 3 зоны",
    oneHour: "1 час",
    twoHours: "2 часа",
    thirtyMin: "30 мин",
    twentyMin: "20 мин",
    fiveMin: "5 мин",
    tenMin: "10 мин",
    yourServices: "Ваши услуги",
    total: "Итого",
    totalLabel: "Итого:",
    continue: "Продолжить",
    chooseTime: "Выберите время",
    barberName: "Имя барбера",
    selectedServices: "Выбранные услуги",
    photo: "Фото",
    personalData: "Личные данные",
    firstName: "Имя",
    lastName: "Фамилия",
    phone: "Номер телефона",
    orderConfirmed: "Ваш заказ подтвержден!",
    pleaseSelectAtLeastOneService: "Пожалуйста, выберите хотя бы одну услугу.",
    pleaseFillPersonalData: "Пожалуйста, заполните все обязательные поля личных данных.",
    pleaseSelectDateAndTime: "Пожалуйста, выберите дату и время.",
    date: "Дата",
    time: "Время",
    finalConfirm: "Подтвердить заказ",
    servicesLabel: "Услуги",
    personalDataLabel: "Личные данные",
    January: "Январь",
    February: "Февраль",
    March: "Март",
    April: "Апрель",
    May: "Май",
    June: "Июнь",
    July: "Июль",
    August: "Август",
    September: "Сентябрь",
    October: "Октябрь",
    November: "Ноябрь",
    December: "Декабрь",
    mon: "Пн",
    tue: "Вт",
    wed: "Ср",
    thu: "Чт",
    fri: "Пт",
    sat: "Сб",
    sun: "Вс",
    selectDate: "не выбрана",
    selectTime: "не выбрано",
    morning: "Утро",
    day: "День",
    evening: "Вечер",
    indexTitle: "Top Man Barbershop",
    aboutTitle: "О нас | Барбершоп",
    aboutHeader: "О нас",
    wantLookPerfectHeader: "Хочешь выглядеть безупречно?",
    wantLookPerfectText: "Приглашаем тебя в наш барбершоп! Опытные мастера создадут неповторимый образ, который подчеркнет твою индивидуальность. Современные стрижки, стильная борода, качественные средства для ухода – все это ждет тебя у нас!",
    visitUsHeader: "Посети нас",
    workingHours: "Пн-Пт: 9:00 - 19:00 | Сб-Вс: 9:00 - 17:00",
    ourTeamHeader: "Наша команда",
    teamMemberAlexandr: "Александр",
    teamMemberTopBarber: "Главный барбер",
    teamMemberRadu: "Раду",
    teamMemberBarber: "Барбер",
    teamMemberEkaterina: "Екатерина",
    teamMemberIvan: "Иван",
    teamMemberJuniorBarber: "Младший барбер",
    slogan: "Стильный уход для джентльменов",
    booking: "Запись",
    haircut: "Стрижка",
    beard: "Оформление бороды",
    waxing: "Ваксинг",
    kidsHaircut: "Детская стрижка",
    shaving: "Бритье",
    styling: "Укладка волос",
    whyUs: "Почему мы?",
    whyUsText1: "Наши барберы — профессионалы своего дела...",
    whyUsText2: "В нашем барбершопе ты сможешь расслабиться...",
    whyUsText3: "Мы предлагаем не просто стрижки и бритье...",
    whyUsText4: "Мы используем только проверенные средства...",
    whyUsText5: "Каждое посещение — это время для себя...",
    address: "Balti, Alexandru cel Bun 40a",
    projectNote: "Сайт сделан в рамках проекта Tekwill"
  },
  en: {
    home: "Home",
    services: "Services",
    about: "About Us",
    contacts: "Contacts",
    step1: "Choose Services",
    step2: "Choose Time",
    step3: "Personal Details",
    step4: "Confirmation",
    topBarber: "Top Barber",
    goodBarber: "Good Barber",
    juniorBarber: "Junior Barber",
    maleHaircut: "Men's Haircut",
    childHaircut: "Kids' Haircut",
    extendedHaircut: "Extended Haircut",
    beardStyling: "Beard Styling",
    beardCamouflage: "Beard Camouflage",
    royalShave: "Royal Shave",
    hairStyling: "Hair Styling",
    beardAndHaircut: "Beard + Haircut",
    hairTattoo: "Hair Tattoo",
    waxing1: "Waxing 1 Zone",
    waxing3: "Waxing 3 Zones",
    oneHour: "1 hour",
    twoHours: "2 hours",
    thirtyMin: "30 min",
    twentyMin: "20 min",
    fiveMin: "5 min",
    tenMin: "10 min",
    yourServices: "Your Services",
    total: "Total",
    totalLabel: "Total:",
    continue: "Continue",
    chooseTime: "Choose Time",
    barberName: "Barber Name",
    selectedServices: "Selected Services",
    photo: "Photo",
    personalData: "Personal Details",
    firstName: "First Name",
    lastName: "Last Name",
    phone: "Phone Number",
    orderConfirmed: "Your order has been confirmed!",
    pleaseSelectAtLeastOneService: "Please select at least one service.",
    pleaseFillPersonalData: "Please fill in all required personal details.",
    pleaseSelectDateAndTime: "Please select a date and time.",
    date: "Date",
    time: "Time",
    finalConfirm: "Confirm Order",
    servicesLabel: "Services",
    personalDataLabel: "Personal Details",
    January: "January",
    February: "February",
    March: "March",
    April: "April",
    May: "May",
    June: "June",
    July: "July",
    August: "August",
    September: "September",
    October: "October",
    November: "November",
    December: "December",
    mon: "Mon",
    tue: "Tue",
    wed: "Wed",
    thu: "Thu",
    fri: "Fri",
    sat: "Sat",
    sun: "Sun",
    selectDate: "Select Date",
    selectTime: "Select Time",
    morning: "Morning",
    day: "Day",
    evening: "Evening",
    indexTitle: "Top Man Barbershop",
    aboutTitle: "About Us | Barbershop",
    aboutHeader: "About Us",
    wantLookPerfectHeader: "Want to look perfect?",
    wantLookPerfectText: "We invite you to our barbershop! Experienced barbers will create a unique look that emphasizes your individuality. Modern haircuts, stylish beard grooming, high-quality care products – all of this awaits you with us!",
    visitUsHeader: "Visit Us",
    workingHours: "Mon-Fri: 9:00 AM - 7:00 PM | Sat-Sun: 9:00 AM - 5:00 PM",
    ourTeamHeader: "Our Team",
    teamMemberAlexandr: "Alexandr",
    teamMemberTopBarber: "Top barber",
    teamMemberRadu: "Radu",
    teamMemberBarber: "Barber",
    teamMemberEkaterina: "Ekaterina",
    teamMemberIvan: "Ivan",
    teamMemberJuniorBarber: "Junior barber",
    slogan: "Stylish care for gentlemen",
    booking: "Booking",
    haircut: "Haircut",
    beard: "Beard trimming",
    waxing: "Waxing",
    kidsHaircut: "Children's haircut",
    shaving: "Shaving",
    styling: "Hair styling",
    whyUs: "Why Us?",
    whyUsText1: "Our barbers are professionals in their field...",
    whyUsText2: "In our barbershop, you can relax...",
    whyUsText3: "We offer not just haircuts and shaves...",
    whyUsText4: "We only use trusted products...",
    whyUsText5: "Every visit is time for yourself...",
    address: "Balti, Alexandru cel Bun 40a",
    projectNote: "Website created as part of the Tekwill project"
  },
  ro: {
    home: "Principală",
    services: "Servicii",
    about: "Despre noi",
    contacts: "Contacte",
    step1: "Alege Servicii",
    step2: "Alege Timpul",
    step3: "Date Personale",
    step4: "Confirmare",
    topBarber: "Top Barber",
    goodBarber: "Good Barber",
    juniorBarber: "Junior Barber",
    maleHaircut: "Tuns bărbați",
    childHaircut: "Tuns copii",
    extendedHaircut: "Tuns extins",
    beardStyling: "Stilizare barbă",
    beardCamouflage: "Camuflaj barbă",
    royalShave: "Bărbier regal",
    hairStyling: "Coafare păr",
    beardAndHaircut: "Barbă + tunsoare",
    hairTattoo: "Hair Tattoo",
    waxing1: "Epilare 1 zonă",
    waxing3: "Epilare 3 zone",
    oneHour: "1 oră",
    twoHours: "2 ore",
    thirtyMin: "30 min",
    twentyMin: "20 min",
    fiveMin: "5 min",
    tenMin: "10 min",
    yourServices: "Serviciile tale",
    total: "Total",
    totalLabel: "Total:",
    continue: "Continuă",
    chooseTime: "Alege Timpul",
    barberName: "Nume Barber",
    selectedServices: "Servicii selectate",
    photo: "Photo",
    personalData: "Date Personale",
    firstName: "Prenume",
    lastName: "Nume de familie",
    phone: "Număr de telefon",
    orderConfirmed: "Comanda dvs. a fost confirmată!",
    pleaseSelectAtLeastOneService: "Vă rugăm să selectați cel puțin un serviciu.",
    pleaseFillPersonalData: "Vă rugăm să completați toate câmpurile obligatorii.",
    pleaseSelectDateAndTime: "Vă rugăm să selectați o dată și o oră.",
    date: "Dată",
    time: "Oră",
    finalConfirm: "Confirmă comanda",
    servicesLabel: "Servicii",
    personalDataLabel: "Date Personale",
    January: "Ianuarie",
    February: "Februarie",
    March: "Martie",
    April: "Aprilie",
    May: "Mai",
    June: "Iunie",
    July: "Iulie",
    August: "August",
    September: "Septembrie",
    October: "Octombrie",
    November: "Noiembrie",
    December: "Decembrie",
    mon: "Lu",
    tue: "Ma",
    wed: "Mi",
    thu: "Jo",
    fri: "Vi",
    sat: "Sâ",
    sun: "Du",
    selectDate: "Selectați data",
    selectTime: "Selectați ora",
    morning: "Dimineață",
    day: "Zi",
    evening: "Seară",
    indexTitle: "Top Man Barbershop",
    aboutTitle: "Despre noi | Barbershop",
    aboutHeader: "Despre noi",
    wantLookPerfectHeader: "Vrei să arăți perfect?",
    wantLookPerfectText: "Te invităm la barbershop-ul nostru! Barbierii experimentați vor crea un look unic care îți va sublinia individualitatea. Tunsori moderne, îngrijire stilată a bărbii, produse de calitate – toate astea te așteaptă la noi!",
    visitUsHeader: "Vizitează-ne",
    workingHours: "Luni-Vineri: 9:00 - 19:00 | Sâmbătă-Duminică: 9:00 - 17:00",
    ourTeamHeader: "Echipa noastră",
    teamMemberAlexandr: "Alexandr",
    teamMemberTopBarber: "Barber de top",
    teamMemberRadu: "Radu",
    teamMemberBarber: "Barber",
    teamMemberEkaterina: "Ekaterina",
    teamMemberIvan: "Ivan",
    teamMemberJuniorBarber: "Barber junior",
    slogan: "Îngrijire stilată pentru bărbați",
    booking: "Programare",
    haircut: "Tuns",
    beard: "Tunsul bărbii",
    waxing: "Vaksing",
    kidsHaircut: "Tunsoare pentru copii",
    shaving: "Bărbierit",
    styling: "Coafură",
    whyUs: "De ce noi?",
    whyUsText1: "Barbierii noștri sunt profesioniști în domeniul lor...",
    whyUsText2: "În barbershop-ul nostru poți să te relaxezi...",
    whyUsText3: "Oferim nu doar tunsori și bărbierit...",
    whyUsText4: "Folosim doar produse de încredere...",
    whyUsText5: "Fiecare vizită este timpul tău pentru tine...",
    address: "Balti, Alexandru cel Bun 40a",
    projectNote: "Site-ul a fost creat în cadrul proiectului Tekwill"
  }
};

let currentLanguage = localStorage.getItem("language") || "ru";

function translate(key) {
  return translations[currentLanguage][key] || key;
}

function updateStaticTexts() {
  document.querySelectorAll("[data-translate]").forEach((element) => {
    const key = element.getAttribute("data-translate");
    if (translations[currentLanguage][key]) {
      element.textContent = translations[currentLanguage][key];
    }
  });
  if (translations[currentLanguage].indexTitle) {
    document.title = translations[currentLanguage].indexTitle;
  }
}

const serviceTextMap = {
  "Мужская стрижка": {
    ru: "Мужская стрижка",
    en: "Men's Haircut",
    ro: "Tuns bărbați"
  },
  "Детская стрижка": {
    ru: "Детская стрижка",
    en: "Kids' Haircut",
    ro: "Tuns copii"
  },
  "Удлиненная стрижка": {
    ru: "Удлиненная стрижка",
    en: "Extended Haircut",
    ro: "Tuns extins"
  },
  "Оформление бороды": {
    ru: "Оформление бороды",
    en: "Beard Styling",
    ro: "Stilizare barbă"
  },
  "Камуфлирование бороды": {
    ru: "Камуфлирование бороды",
    en: "Beard Camouflage",
    ro: "Camuflaj barbă"
  },
  "Королевское бритье": {
    ru: "Королевское бритье",
    en: "Royal Shave",
    ro: "Bărbier regal"
  },
  "Укладка волос": {
    ru: "Укладка волос",
    en: "Hair Styling",
    ro: "Coafare păr"
  },
  "Борода + стрижка": {
    ru: "Борода + стрижка",
    en: "Beard + Haircut",
    ro: "Barbă + tunsoare"
  },
  "Hair tatoo": {
    ru: "Hair tatoo",
    en: "Hair Tattoo",
    ro: "Hair Tattoo"
  },
  "Ваксинг 1 зона": {
    ru: "Ваксинг 1 зона",
    en: "Waxing 1 Zone",
    ro: "Epilare 1 zonă"
  },
  "Ваксинг 3 зоны": {
    ru: "Ваксинг 3 зоны",
    en: "Waxing 3 Zones",
    ro: "Epilare 3 zone"
  }
};

function getFirstNonEmptyTextNode(el) {
  for (let child of el.childNodes) {
    if (child.nodeType === Node.TEXT_NODE && child.textContent.trim() !== "") {
      return child;
    }
  }
  return null;
}

function updateDynamicServices() {
  document.querySelectorAll(".service-card p").forEach(function (p) {
    let original = p.getAttribute("data-original");
    if (!original) {
      original = p.textContent.trim();
      p.setAttribute("data-original", original);
    }
    if (serviceTextMap[original]) {
      p.textContent = serviceTextMap[original][currentLanguage] || original;
    }
  });
  document.querySelectorAll(".order-list li").forEach(function (li) {
    let textNode = getFirstNonEmptyTextNode(li);
    if (!textNode) return;
    let text = textNode.textContent.trim();
    let parts = text.split(" - ");
    if (parts.length >= 2) {
      let originalService = parts[0];
      let rest = parts.slice(1).join(" - ");
      if (serviceTextMap[originalService]) {
        textNode.textContent = serviceTextMap[originalService][currentLanguage] || originalService;
        textNode.textContent += " - " + rest;
      }
    }
  });
}

const dynamicObserver = new MutationObserver(() => {
  updateDynamicServices();
});

document.addEventListener("DOMContentLoaded", function () {
  const servicesContainer = document.querySelector(".services-container");
  const orderMenu = document.querySelector(".order-menu");
  if (servicesContainer) {
    dynamicObserver.observe(servicesContainer, {
      childList: true,
      subtree: true
    });
  }
  if (orderMenu) {
    dynamicObserver.observe(orderMenu, {
      childList: true,
      subtree: true
    });
  }
});

document.addEventListener("DOMContentLoaded", function () {
  const languageSelect = document.querySelector("#languageSelect");
  languageSelect.value = currentLanguage;
  languageSelect.addEventListener("change", function (event) {
    currentLanguage = event.target.value;
    localStorage.setItem("language", currentLanguage);
    updateStaticTexts();
    updateDynamicServices();
  });
  updateStaticTexts();
  updateDynamicServices();
});